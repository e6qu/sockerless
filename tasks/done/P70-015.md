# P70-015: Azure — Functions Log Injection

**Component:** SIM (simulators/azure)
**Phase:** 70 — Milestone 3 (Azure Fidelity)
**Depends on:** P70-013
**Estimated effort:** M

---

## Description

The Azure Functions handler (`functions.go`) must auto-write log entries to
the Log Analytics store when function apps are invoked. The Azure Functions
backend queries `AppTraces` table with `where AppRoleName == '{appName}'`.

## Context

- `simulators/azure/functions.go`: invokes functions but writes no logs
- Backend `backends/azure-functions/logs.go:57`: queries `AppTraces` table

## Acceptance Criteria

1. When a function app is invoked via `POST /api/function`, at least one
   log entry is written
2. Entry uses `AppTraces` table schema with columns:
   - `TimeGenerated` (RFC3339 timestamp)
   - `Message` (log content)
   - `AppRoleName` (function app name)
3. Entries are retrievable via KQL query with `where AppRoleName == '{name}'`
4. New test verifies: Create function app → invoke → query logs → entries found

## Definition of Done

- [ ] `go build ./...` passes
- [ ] All existing tests pass
- [ ] New test passes
- [ ] PR created via `gh pr create`, CI passes, merged via `gh pr merge`

## Suggested File Paths

- `simulators/azure/functions.go` — inject log entry on invoke
- `simulators/azure/sdk-tests/functions_test.go` — new test
