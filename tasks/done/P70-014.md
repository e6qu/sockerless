# P70-014: Azure — Container Apps Log Injection

**Component:** SIM (simulators/azure)
**Phase:** 70 — Milestone 3 (Azure Fidelity)
**Depends on:** P70-013
**Estimated effort:** M

---

## Description

The Container Apps handler (`containerapps.go`) must auto-write log entries
to the Log Analytics store when executions run. Without this, the ACA
backend's KQL queries against `ContainerAppConsoleLogs_CL` always return empty.

## Context

- `simulators/azure/containerapps.go`: creates executions but writes no logs
- `simulators/azure/monitor.go`: has data ingestion endpoint and log store
- Backend `backends/aca/logs.go:91`: queries `ContainerAppConsoleLogs_CL`
  with `where ContainerGroupName_s == '{jobName}'`
- AWS simulator already does this for ECS: `simulators/aws/ecs.go:582`

## Acceptance Criteria

1. When a job execution starts, at least one log entry is written to the
   monitor's log store
2. Entry uses `ContainerAppConsoleLogs_CL` table schema with columns:
   - `TimeGenerated` (RFC3339 timestamp)
   - `ContainerGroupName_s` (job name)
   - `Log_s` (log message content)
   - `Stream_s` ("stdout" or "stderr")
3. When execution completes, another entry is written
4. Entries are retrievable via the query endpoint with correct KQL filtering
5. Existing tests pass unchanged
6. New test verifies: Start execution → query logs → entries found

## Definition of Done

- [ ] `go build ./...` passes
- [ ] All existing tests pass
- [ ] New test passes
- [ ] PR created via `gh pr create`, CI passes, merged via `gh pr merge`

## Suggested File Paths

- `simulators/azure/containerapps.go` — inject log entries on execution lifecycle
- `simulators/azure/monitor.go` — may need to export store or add helper
- `simulators/azure/sdk-tests/containerapps_test.go` — extend with log verification
