# P70-009: GCP — Cloud Functions Log Entry Injection

**Component:** SIM (simulators/gcp)
**Phase:** 70 — Milestone 2 (GCP Fidelity)
**Depends on:** P70-007
**Estimated effort:** M

---

## Description

The Cloud Functions handler (`cloudfunctions.go`) must auto-write log entries
to the Cloud Logging store when functions are invoked. The Cloud Functions
backend queries with `resource.type="cloud_run_revision"` and
`resource.labels.service_name="{name}"`.

## Context

- `simulators/gcp/cloudfunctions.go`: invokes functions but writes no logs
- Backend `backends/cloudrun-functions/logs.go:59`: queries with filter
  `resource.type="cloud_run_revision" AND resource.labels.service_name="{name}"`
- Cloud Functions v2 is backed by Cloud Run internally, hence `cloud_run_revision`

## Acceptance Criteria

1. When a function is invoked via `POST /v2-functions-invoke/{id}`, at least
   one log entry is written
2. Entry has `resource.type = "cloud_run_revision"`
3. Entry has `resource.labels.service_name = "{functionName}"`
4. Entry has `textPayload` with meaningful content
5. Entry has a valid `timestamp`
6. Entries are retrievable via `entries:list` with the correct filter
7. New test verifies: CreateFunction → Invoke → list entries → entries found

## Definition of Done

- [ ] `go build ./...` passes
- [ ] All existing tests pass
- [ ] New test passes
- [ ] PR created via `gh pr create`, CI passes, merged via `gh pr merge`

## Suggested File Paths

- `simulators/gcp/cloudfunctions.go` — inject log entry on invoke
- `simulators/gcp/sdk-tests/functions_test.go` — new test

## Notes

- Reuse the same log injection helper from P70-008
- The function name in `service_name` should be the short name (not full path)
