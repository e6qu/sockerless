# P25-004: Run gitlab-ci-local tests and document results

**Status:** DONE
**Phase:** 25

## Summary

Ran gitlab-ci-local upstream tests against Sockerless memory backend. All 15 tests pass.

## Key Finding: Pre-Start `docker cp` Fix

gitlab-ci-local calls `docker cp` before `docker start`, which failed because the memory backend's WASM sandbox filesystem only exists after container start. Fixed by adding staging directory support to `backends/core/handle_containers.go`.

## Changes

### `backends/core/store.go`
- Added `StagingDirs sync.Map` to Store struct

### `backends/core/handle_containers.go`
- **PUT archive handler**: Extracts to staging dir when no process exists (instead of discarding)
- **HEAD archive handler**: Stats staging dir for pre-start queries; returns 404 for non-existent paths (was returning synthetic stat)
- **GET archive handler**: Reads from staging dir; returns 404 for non-existent paths (was returning empty tar)
- **handleContainerStart**: Merges staging dir into process root after process creation
- Added `getOrCreateStagingDir()` and `mergeStagingDir()` helpers

### `tests/upstream/gitlab-ci-local/RESULTS.md`
- Documented 15 PASS / 0 FAIL baseline results

## Results

- 15 PASS, 0 FAIL
- All 12 original + 3 expanded test cases pass
