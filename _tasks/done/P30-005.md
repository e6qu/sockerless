# P30-005: Refactor handlers + wire up memory backend

**Component:** Core (backends/core), Memory (backends/memory)
**Phase:** 30
**Status:** DONE

---

Refactored handler code to dispatch through driver interfaces:
- `handle_exec.go`: Replaced 4-way if/else chain with `s.Drivers.Exec.Exec()`
- `handle_containers.go`: Replaced archive 3-tier branching, attach branching, and process lifecycle with driver calls
- `handle_extended.go`: Replaced direct process cleanup in prune with `s.Drivers.ProcessLifecycle.Cleanup()`
- `server.go`: Added `Drivers DriverSet` field, `InitDrivers()` method, auto-called from `NewBaseServer()`
- `memory/server.go`: Re-calls `InitDrivers()` after setting ProcessFactory

Removed `agent` import from `handle_containers.go` and `handle_exec.go` (moved to driver layer).
