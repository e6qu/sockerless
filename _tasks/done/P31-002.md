# P31-002: Add 12 new Go-implemented builtins

**Phase:** 31
**Status:** Done
**Date:** 2026-02-21

## What

Added 12 new builtins to the WASM sandbox, bringing total Go-implemented builtins to 21:

| Builtin | Purpose |
|---|---|
| `touch` | Create files / update timestamps |
| `base64` | Encode/decode (`-d` flag), reads stdin |
| `basename` | Extract filename from path |
| `dirname` | Extract directory from path |
| `which` | Command lookup (builtins + applets + PATH) |
| `seq` | Number sequences (1-3 args) |
| `readlink` | Resolve symlinks (`-f` flag), rootDir-aware |
| `tee` | Duplicate stdin to file + stdout (`-a` append) |
| `ln` | Create links (`-s`, `-f` flags) |
| `stat` | File stats (`-c` format: `%s`, `%n`, `%F`) |
| `sha256sum` | SHA-256 checksums from files or stdin |
| `md5sum` | MD5 checksums from files or stdin |

## Implementation Details

- All builtins implemented as standalone functions in `sandbox/builtins.go`
- Shared `resolvePathForBuiltin()` helper for path resolution (abs→rootDir, rel→hc.Dir)
- `readlink -f` uses manual symlink resolution loop (not `filepath.EvalSymlinks` which follows host paths)
- `dirname` strips trailing slashes before `filepath.Dir()` to match GNU behavior
- `builtinCommands` and `fileArgCommands` maps updated in `shell.go`

## Files Changed

- `sandbox/builtins.go` — NEW: all builtin implementations
- `sandbox/shell.go` — dispatch calls, map updates

## Tests Added

12 tests in `sandbox/sandbox_test.go`, one per builtin.
