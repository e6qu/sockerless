# P32-006: Split handle_containers.go into 3 files

**Phase:** 32B (Code Splitting)
**Depends on:** P32-005 (all driver bypasses removed first)
**Estimated effort:** M

---

## Description

Split `backends/core/handle_containers.go` (829 lines) into three files organized by responsibility. Target: each file under 350 lines.

## File Split Plan

### `handle_containers.go` — Lifecycle (~400 lines)

Keep these functions (they form the core create/start/stop/kill/remove/restart lifecycle):
- `handleContainerCreate` (~112 lines)
- `handleContainerStart` (~92 lines)
- `handleContainerStop` (~18 lines)
- `handleContainerKill` (~39 lines)
- `handleContainerRemove` (~32 lines)
- `handleContainerRestart` (~51 lines)
- `resolveBindMounts` (~34 lines)

### `handle_container_query.go` — Query & Streaming (~200 lines)

Move these read-only / streaming handlers:
- `handleContainerInspect` (~9 lines)
- `handleContainerList` (~44 lines)
- `handleContainerWait` (~55 lines)
- `handleContainerLogs` (~53 lines)
- `handleContainerAttach` (~44 lines)

### `handle_archive.go` — Archive Operations (~200 lines)

Move these archive/filesystem handlers and helpers:
- `handlePutArchive` (~18 lines)
- `handleHeadArchive` (~28 lines)
- `handleGetArchive` (~31 lines)
- `extractTar` (~27 lines) — free function, not a method
- `createTar` (~54 lines) — free function, not a method
- `mergeStagingDir` (~37 lines)

## How to Split

1. Create `handle_container_query.go` with the `package core` header and relevant imports
2. Move the 5 query/streaming functions there
3. Create `handle_archive.go` with the `package core` header and relevant imports
4. Move the 6 archive functions there
5. Verify `handle_containers.go` now has only the 7 lifecycle functions
6. Run `make test && make lint` to ensure no issues

**Important:** `extractTar` and `createTar` are free functions (not methods on `*BaseServer`) also used by `drivers_process.go` and `drivers_synthetic.go`. They must remain exported or stay in a file that both can import. Since they're in the same package, any file works.

## Acceptance Criteria

1. `handle_containers.go` ≤ 400 lines (lifecycle only)
2. `handle_container_query.go` exists with inspect, list, wait, logs, attach
3. `handle_archive.go` exists with put/head/get archive, extractTar, createTar, mergeStagingDir
4. All tests pass: `make test`, `make lint`
5. No behavior changes

## After Completing

Update `_tasks/done/P32-006.md`. Update `STATUS.md` progress line.
