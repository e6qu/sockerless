# P32-002: Add LogBytes to StreamDriver

**Phase:** 32A (Driver Interface Extension)
**Depends on:** â€”
**Estimated effort:** S

---

## Description

Add `LogBytes` to `StreamDriver` so `handleContainerLogs` doesn't need to call `s.Store.Processes.Load()`.

## What to Change

### 1. Extend `StreamDriver` interface in `backends/core/drivers.go`

Add:
```go
// LogBytes returns buffered log output for the container.
// Returns nil if no logs are available.
LogBytes(containerID string) []byte
```

### 2. Implement in all three driver tiers

**WASMStreamDriver** (`drivers_process.go`):
```go
func (d *WASMStreamDriver) LogBytes(containerID string) []byte {
    if wp, ok := d.Store.Processes.Load(containerID); ok {
        return wp.(ContainerProcess).LogBytes()
    }
    return nil
}
```

**SyntheticStreamDriver** (`drivers_synthetic.go`):
```go
func (d *SyntheticStreamDriver) LogBytes(containerID string) []byte {
    if logData, ok := d.Store.LogBuffers.Load(containerID); ok {
        return logData.([]byte)
    }
    return nil
}
```

**AgentStreamDriver** (`drivers_agent.go`):
```go
func (d *AgentStreamDriver) LogBytes(containerID string) []byte {
    return d.Fallback.LogBytes(containerID)
}
```

### 3. Update handler code in `handle_containers.go`

Replace the bypass in `handleContainerLogs` (lines 452-460):
```go
// BEFORE:
var logBytes []byte
if wp, ok := s.Store.Processes.Load(id); ok {
    logBytes = wp.(ContainerProcess).LogBytes()
} else {
    logData, _ := s.Store.LogBuffers.Load(id)
    if logData != nil {
        logBytes = logData.([]byte)
    }
}

// AFTER:
logBytes := s.Drivers.Stream.LogBytes(id)
```

## Acceptance Criteria

1. `StreamDriver` interface has `LogBytes(containerID string) []byte`
2. All three tiers implement the method
3. `handleContainerLogs` uses `s.Drivers.Stream.LogBytes()` instead of `Store.Processes.Load`
4. All tests pass: `make test`, `make lint`

## After Completing

Update `_tasks/done/P32-002.md` with actual changes. Update `STATUS.md` progress line.
