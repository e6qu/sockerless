# P65-003: Auth Middleware Extension

**Status:** Done
**Phase:** 65 — GitHub Apps

## What
Modified `bleephub/gh_middleware.go` to recognize three auth types: JWT (looksLikeJWT → parseAndVerifyAppJWT → ctxApp), ghs_ installation tokens (LookupInstallationToken → ctxInstallation + synthetic bot user for backward compat), and PAT (existing behavior). Added context keys ctxApp, ctxInstallation and helpers ghAppFromContext, ghInstallationFromContext.

## Tests
Integration tests: TestGetAuthenticatedAppNoJWT401, TestInstallationTokenAuth, TestExistingPATAuthUnaffected
